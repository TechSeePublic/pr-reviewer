# ğŸ¤– Cursor AI PR Reviewer

An AI-powered GitHub Action that automatically reviews pull requests according to your project's Cursor AI rules. This bot respects all Cursor rule formats including the new `.cursor/rules/*.mdc` format, `AGENTS.md`, and legacy `.cursorrules`.

## âœ¨ Features

- ğŸ¯ **Respects Cursor Rules** - Supports all Cursor rule formats (`.cursor/rules/*.mdc`, `AGENTS.md`, `.cursorrules`)
- ğŸ” **Smart Code Analysis** - AI-powered review using OpenAI or Anthropic
- ğŸ’¬ **Dual Comment System** - Both inline file comments and PR summary comments
- âš™ï¸ **Highly Configurable** - Customize review behavior, severity levels, and comment styles
- ğŸš€ **Zero Infrastructure** - Runs entirely on GitHub Actions, no servers needed
- ğŸ›¡ï¸ **Secure** - Code never leaves GitHub's infrastructure
- ğŸ“Š **Comprehensive Reporting** - Detailed review statistics and rule application tracking

## ğŸš€ Quick Start

### 1. Add to Your Workflow

Create `.github/workflows/pr-review.yml`:

```yaml
name: PR Review
on:
  pull_request:
    types: [opened, synchronize]

jobs:
  review:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: AI Code Review
        uses: amit.wagner/pr-reviewer@v1
        with:
          gh_token: ${{ secrets.GH_TOKEN }}
          openai_api_key: ${{ secrets.OPENAI_API_KEY }}
          review_level: 'standard'
          comment_style: 'both'
```

### 2. Set Up API Keys

Add your AI provider API key to GitHub Secrets:
- `OPENAI_API_KEY` for OpenAI (recommended)
- `ANTHROPIC_API_KEY` for Anthropic Claude

### 3. Configure Cursor Rules

The bot automatically detects and applies Cursor rules from:
- `.cursor/rules/*.mdc` files (new format)
- `AGENTS.md` file in project root
- `.cursorrules` file (legacy format)

## ğŸ“‹ Configuration Options

| Input | Description | Default | Required |
|-------|-------------|---------|----------|
| `gh_token` | GitHub token for API access | `${{ github.token }}` | âœ… |
| `openai_api_key` | OpenAI API key | - | âš ï¸ |
| `anthropic_api_key` | Anthropic API key | - | âš ï¸ |
| `ai_provider` | AI provider (`openai`, `anthropic`, `auto`) | `auto` | âŒ |
| `model` | AI model to use | `auto` | âŒ |
| `review_level` | Review intensity (`light`, `standard`, `thorough`) | `standard` | âŒ |
| `comment_style` | Comment style (`inline`, `summary`, `both`) | `both` | âŒ |
| `inline_severity` | Min severity for inline comments (`error`, `warning`, `info`, `all`) | `warning` | âŒ |
| `summary_format` | Summary format (`brief`, `detailed`, `minimal`) | `detailed` | âŒ |
| `include_patterns` | File patterns to include (comma-separated) | `**/*.ts,**/*.tsx,**/*.js,**/*.jsx,**/*.py,**/*.go,**/*.rs,**/*.java,**/*.cs` | âŒ |
| `exclude_patterns` | File patterns to exclude (comma-separated) | `node_modules/**,dist/**,build/**,coverage/**,*.min.js,*.bundle.js` | âŒ |
| `max_files` | Maximum files to review | `50` | âŒ |
| `enable_suggestions` | Enable code suggestions | `true` | âŒ |
| `skip_if_no_rules` | Skip review if no rules found | `false` | âŒ |
| `update_existing_comments` | Update existing bot comments | `true` | âŒ |

âš ï¸ *At least one AI provider API key is required*

## ğŸ¨ Comment Examples

### Inline Comments
```markdown
## ğŸ¤– Cursor Rule Violation

**âš ï¸ WARNING:** Missing type annotation

Function parameters should have explicit TypeScript types according to your project's Cursor rules.

**ğŸ“‹ Rule:** `typescript-strict` - Always use TypeScript types

**ğŸ’¡ Suggestion:**
```typescript
const onClick = (e: React.MouseEvent<HTMLButtonElement>) => {
```

---
*Generated by Cursor AI PR Reviewer*
```

### Summary Comments
```markdown
## ğŸ¤– Cursor AI PR Review Summary

### âš ï¸ **Overall Status: NEEDS ATTENTION**

### ğŸ“Š **Review Statistics**
- **Files Reviewed:** 8/12
- **Issues Found:** 3
- **Rules Applied:** 5

### âš ï¸ **Issues by Type**
- **âš ï¸ WARNING:** 2
- **â„¹ï¸ INFO:** 1

### ğŸ“ **Cursor Rules Applied**
- ğŸ”’ `typescript-strict` - Always use TypeScript types
- ğŸ“ `react-patterns` - React component patterns
- ğŸ¤– `code-style` - Project code style guide

### ğŸ¯ **Assessment**
Great work on the new feature! Just a few TypeScript type annotations needed to fully comply with your Cursor rules.

### ğŸš€ **Next Steps**
1. Review the 3 issues identified above
2. Apply the suggested fixes
3. Push changes to trigger a new review

---
*Generated by Cursor AI PR Reviewer v1.0.0*
```

## ğŸ›ï¸ Advanced Configuration

### Custom Review Levels

```yaml
# Light review - basic rule checking only
- uses: amit.wagner/pr-reviewer@v1
  with:
    review_level: 'light'
    inline_severity: 'error'

# Thorough review - comprehensive analysis
- uses: amit.wagner/pr-reviewer@v1
  with:
    review_level: 'thorough'
    inline_severity: 'info'
    summary_format: 'detailed'
```

### File Pattern Filtering

```yaml
# Review only TypeScript files
- uses: amit.wagner/pr-reviewer@v1
  with:
    include_patterns: '**/*.ts,**/*.tsx'
    exclude_patterns: '**/*.test.ts,**/*.spec.ts'
```

### Multiple AI Providers

```yaml
# Prefer Anthropic, fallback to OpenAI
- uses: amit.wagner/pr-reviewer@v1
  with:
    ai_provider: 'anthropic'
    anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
    openai_api_key: ${{ secrets.OPENAI_API_KEY }}
```

## ğŸ“š Cursor Rules Support

### New Format (`.cursor/rules/*.mdc`)

```markdown
---
description: TypeScript strict typing rules
globs: ["**/*.ts", "**/*.tsx"]
alwaysApply: false
---

# TypeScript Rules

- Always use explicit types for function parameters
- Avoid `any` type
- Use strict null checks

@typescript-template.ts
```

### AGENTS.md Format

```markdown
# Project Instructions

## Code Style
- Use TypeScript for all new files
- Prefer functional components in React
- Use snake_case for database columns

## Architecture
- Follow the repository pattern
- Keep business logic in service layers
```

### Legacy Format (`.cursorrules`)

```
Use TypeScript strict mode
Follow React best practices
Implement proper error handling
```

## ğŸ”§ Development

### Local Development

```bash
# Clone the repository
git clone https://github.com/amit.wagner/pr-reviewer.git
cd pr-reviewer

# Install dependencies
npm install

# Run tests
npm test

# Build
npm run build

# Run linting
npm run lint
```

### Release Process

```bash
# Patch release
npm run release patch

# Minor release
npm run release minor

# Major release
npm run release major

# Specific version
npm run release 1.2.3
```

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/amazing-feature`
3. Make your changes
4. Add tests for new functionality
5. Ensure all tests pass: `npm test`
6. Commit your changes: `git commit -m 'Add amazing feature'`
7. Push to the branch: `git push origin feature/amazing-feature`
8. Open a Pull Request

## ğŸ› Troubleshooting

### Common Issues

**"No AI provider API key available"**
- Ensure you've set either `OPENAI_API_KEY` or `ANTHROPIC_API_KEY` in GitHub Secrets

**"This action can only be run on pull request events"**
- Make sure your workflow triggers on `pull_request` events

**"Working directory is not clean"**
- Ensure the repository is checked out in your workflow before running the action

**Rate limit issues**
- The action automatically handles GitHub API rate limits
- For AI provider rate limits, consider using `review_level: 'light'`

### Debug Mode

Enable debug logging by setting the `ACTIONS_STEP_DEBUG` secret to `true` in your repository.

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ™ Acknowledgments

- [Cursor](https://cursor.sh/) for the amazing AI-powered development environment
- [GitHub Actions](https://github.com/features/actions) for the CI/CD platform
- [OpenAI](https://openai.com/) and [Anthropic](https://anthropic.com/) for AI capabilities

## ğŸ“ Support

- ğŸ“– [Documentation](https://github.com/amit.wagner/pr-reviewer#readme)
- ğŸ› [Issue Tracker](https://github.com/amit.wagner/pr-reviewer/issues)
- ğŸ’¬ [Discussions](https://github.com/amit.wagner/pr-reviewer/discussions)

---

<div align="center">

**Made with â¤ï¸ by the Cursor AI community**

[â­ Star this repo](https://github.com/amit.wagner/pr-reviewer) â€¢ [ğŸ› Report bug](https://github.com/amit.wagner/pr-reviewer/issues) â€¢ [âœ¨ Request feature](https://github.com/amit.wagner/pr-reviewer/issues)

</div>
